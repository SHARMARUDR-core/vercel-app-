<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="input.css">
</head>
<body class="flex justify-center items-center h-screen w-screen bg-slate-500" > 

    <h1 class="text-2xl text-slate-800">Admin</h1>
    <hr>
    <h3>add item</h3>
    <form action="/items"  method="POST" id ='form'>
        <input name = 'name' type="text" placeholder="name" value='rudr'  required>
        <input name = 'price' type='number' placeholder="price" value='9848' required>
        <input name = 'url' type="text" placeholder="url" value="https://i.pinimg.com/control/236x/0a/cc/c1/0accc1031b485cd1e0e1748da369cf43.jpg" required>
        <input name="typeOf" type="text" placeholder="veg/NonVeg" value="" required>
        <input name = 'description' type="text" placeholder="description" value="" required>
        <button onclick="handleSubmit()">submit</button>
    </form>

    <hr>
    <h3>Remove item</h3>
    <form action="/items" method="POST" id  = 'form-remove'>
        <input type="text" placeholder="name of an item" value="name" name="name">
        <button onclick="Remove()"> Remove </button> 
    </form>

    <script>
        document.getElementById('form').addEventListener('click' , function(e) {
            e.preventDefault()
        })
        document.getElementById('form-remove').addEventListener('click' , function(e) {
            e.preventDefault()
        })
        const form = document.getElementById('form')
        const form_remove = document.getElementById('form-remove')
/////////                     Removing item
function Remove() {
    const formData = new FormData(form_remove);    
    const data = {};    
    for (const [key, value] of formData.entries()) {
        data[key] = value; // Storing key-value pairs properly
    }
    
    // Send the name as part of the URL
    fetch(`http://localhost:5000/items/${data.name}`, {
        method: 'DELETE',
        headers: {
            'Content-Type': 'application/json',
        }
    })
    .then(res => res.json())  // Assuming server responds with JSON
    .then(response => console.log(response.message))  // Handle the response
    .catch(err => console.error('Error:', err));  // Catch errors properly
}

/////////                   adding item 
        function handleSubmit() {
            const formData = new FormData(form);    
            const data = {};    

            // Iterate over form data and build the object
            for (const [key, value] of formData.entries()) {
                data[key] = value; // Storing key-value pairs properly
            }
            
            console.log(data)
            // Fetch request to send form data
            fetch('http://localhost:5000/items', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    name: data.name, 
                    price: data.price, 
                    url: data.url ,
                    typeOf : data.typeOf ,
                    description : data.description
                }), 
            })
            .then(res => res.text())
            .then(e => console.log(e))
            .catch(err => console.log(err)); // Catching errors properly
        }

////////                           json file of items
        fetch('http://localhost:5000/data')
        .then((res) => res.json())
        .then(console.log)
    </script>
</body>
</html>